resource count:int

proc use_test use !io
    use count in
        ?count = 0
        !inc_count
        use count in
            !inc_count
            !inc_count
            !inc_count
            !print("Inner count: ")
            !println(count)
        end
        !print("Outer count: ")
        !println(count)
    end
end

proc inc_count use !count
    ?count = count + 1
end

!use_test
