# Tests for wybe's support for test procs, ie, procs that can succeed or fail

public test proc lt(x:int, y:int)
    # use a boolean-valued expression as a test
    test x < y
end

public type map = empty | node(left:map, key:int, value:int, right:map) end

public test proc lookup(key:int, map:map, ?result:int)
    if map = empty:: test false
    |  key = map.key:: ?result = map.value
    |  key < map.key:: lookup(key, map.left, ?result)
    |  true:: lookup(key, map.right, ?result)
    end
end
