# (1) analyse condition switches?

# Recursive data type:
# will the entire data structure escape?

use mytree

public func simpleMerge(tl:tree, tr:tree):tree =
  if tl = node(?l1, ?k1, ?r1) then
    if tr = node(?l2, ?k2, ?r2) then
      if k1 < k2 then node(tl, k2, r2)
      else node(l1, k1, t2)
    else node(empty, 0, empty)
  else node(empty, 0, empty)

?t1 = node(empty, 222, empty)
?t2 = node(empty, 111, empty)
?t = simpleMerge(t1, t2)
!printTree(t)

#if t1 = node(?l, ?k, ?r) :: ?t1 = node(l, 1000, r)
#end
#!printTree(t1)
#!printTree(t)